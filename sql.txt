1050. Actors and Directors Who Cooperated At Least Three Times
# Write your MySQL query statement below
SELECT actor_id, director_id
FROM (
    SELECT actor_id, director_id, COUNT(*) as cnt
    FROM ActorDirector
    GROUP BY actor_id, director_id
) AS pairs
WHERE pairs.cnt >= 3;


1407. Top Travellers
# Write your MySQL query statement below
SELECT u.name, IFNULL(SUM(distance), 0) as travelled_distance
FROM Users u
LEFT JOIN Rides r ON u.id = r.user_id
GROUP BY u.id
ORDER BY travelled_distance DESC, name ASC;


1280. Students and Examinations
# Write your MySQL query statement below
SELECT s.student_id, s.student_name, s.subject_name, IFNULL(e.cnt, 0) AS attended_exams
FROM (
    SELECT st.student_id, st.student_name, sub.subject_name
    FROM Students st
    CROSS JOIN Subjects sub
) s
LEFT JOIN (
    SELECT e.student_id, e.subject_name, IFNULL(COUNT(*), 0) as cnt
    FROM Subjects s
    LEFT JOIN Examinations e 
    ON s.subject_name = e.subject_name
    GROUP BY e.student_id, e.subject_name
) e
ON s.student_id = e.student_id AND s.subject_name = e.subject_name
ORDER BY s.student_id, s.subject_name


1683. Invalid Tweets
# Write your MySQL query statement below
SELECT tweet_id
FROM Tweets
WHERE LENGTH(content) > 15


1587. Bank Account Summary II
# Write your MySQL query statement below
SELECT u.name, SUM(t.amount) AS balance
FROM Users u
LEFT JOIN Transactions t
ON u.account = t.account
GROUP BY u.account
HAVING balance > 10000;


1633. Percentage of Users Attended a Contest
# Write your MySQL query statement below
SELECT r.contest_id, ROUND(r.cnt/u.num*100, 2) AS percentage
FROM (
    SELECT *
    FROM Users usr, (SELECT COUNT(*) AS num FROM Users) c
) u
LEFT JOIN (
    SELECT *, COUNT(*) AS cnt
    FROM Register
    GROUP BY contest_id
) r ON u.user_id = r.user_id 
WHERE contest_id IS NOT NULL
ORDER BY percentage DESC, r.contest_id ASC;


1757. Recyclable and Low Fat Products
# Write your MySQL query statement below
SELECT product_id
FROM Products
WHERE low_fats = 'Y' AND recyclable = 'Y';


